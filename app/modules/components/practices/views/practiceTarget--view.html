<div data-ng-include="'/templates/header--view.html'"></div>

<main class="site--content--flow fluid-content clearfix distinguish">

    <div id="sidebar" data-ng-include="'/templates/side-bar.html'"></div>

    <div data-ng-if="page.practice.category"
            class="content--container"
         style="border-right: 1px solid #e0e0e0;">

        <div class="main--ui breadcrumb-ui">
           <div class="group">
                    <article class="breadcrumb" >
                        <nobr>
                            Project: <a href="/projects/{{page.practice.project.id}}">{{page.practice.project.name}}</a>
                                /
                               <!-- <sub><i class="icon material-icons" style=""> chevron_right</i></sub> -->
                            Site: <a href="/sites/{{page.practice.site.id}}">{{page.practice.site.name}}</a>
                                /
                            Practice: <a href="/practices/{{page.practice.id}}">{{ page.practice.name }}</a>
                                / Targets
                        </nobr>
                    </article>
                </div>
        </div>

        <h1 class="inset">{{ page.practice.name || 'Un-named' }} &middot; Targets</h1>

        <div class="main--ui target-ui reveal fade-in t0">

            <p>The metrics listed here are associated with the <strong>{{ page.practice_category.name }}</strong> practice type and the <strong>{{ page.practice.site.name }}</strong> site. Assign targets to this practice by entering a numeric value for one or more metrics.</p>

            <h2>{{ page.practice_category.name }} &middot; Definition</h2>

            <div>

                <p data-ng-if="page.practice_category.description" style="width:70%">
                    {{ page.practice_category.description }}
                </p>
                <p data-ng-if="!page.practice_category.description" style="width:70%">
                   This Practice Type's definition has not been defined.
                </p>
            </div>

            <div data-ng-if="page.models.length">

                <h2>Modeled metrics</h2>

                <div data-ng-repeat="model in page.models" style="min-height:25px; display:block; clear:both;">

                    <p style="display:block; clear:both;"><a href="/models/{{ model.model.id }}" title="{{ model.model.name }}">{{ model.model.name }}</a></p>

                     <p data-ng-if="page.practice.category.require_inputs">This conservation practice is <a href="/models/{{ model.model.id }}" title="{{ model.model.name }}">linked to an automated model</a> that calculates estimated values for the parameters below. When you add the required inputs, FieldDoc will run the model behind the scenes and display metric outputs in the practice summary page. If these metrics don’t appear in the practice summary, it means that FieldDoc was unable to supply the model with sufficient and/or valid data for this practice type. <a href="/practices/{{ page.practice.id }}/model-data">Click here to add or modify model inputs.</a></p>


               <!--     <p data-ng-if="!page.practice.category.require_inputs">This conservation practice is <a href="/models/{{ model.model.id }}" title="{{ model.model.name }}">linked to an automated model</a> that calculates estimated values for the parameters below. As you add categorical and spatial data to this practice, FieldDoc will run the model behind the scenes and display metric outputs in the practice summary page. If these metrics don’t appear in the practice summary, it means that FieldDoc was unable to supply the model with sufficient and valid data for this practice type.</p>

                    <p data-ng-if="page.practice.category.require_inputs">This conservation practice is <a href="/models/{{ model.model.id }}" title="{{ model.model.name }}">linked to an automated model</a> that calculates estimated values for the parameters below. When you add the required inputs, FieldDoc will run the model behind the scenes and display metric outputs in the practice summary page. If these metrics don’t appear in the practice summary, it means that FieldDoc was unable to supply the model with sufficient and/or valid data for this practice type. <a href="/practices/{{ page.practice.id }}/model-data">Click here to add or modify model inputs.</a></p>
                -->
           <!--         <ul class="snapshot--cards list-unstyled" style="margin-top: 2em;">

                        <li class="card reveal fade-in" style="animation-delay: {{ $index * 100 }}ms; min-height: 1em;" data-ng-repeat="metric in model.metrics | orderBy:'name'">

                            <div class="card--content">

                                <div class="name" style="border-bottom: none;">
                                    <span>{{ metric.name || 'Un-named' }}</span>
                                    <span style="font-size: 0.7em; font-weight: normal; color: #757575; text-transform: uppercase;" data-ng-if="metric.unit">{{ metric.unit.symbol }} &middot; {{ metric.unit.plural }}</span>
                                    <span style="font-size: 0.7em; font-weight: normal; color: #757575; text-transform: uppercase;" data-ng-if="!metric.unit">Unit-less</span>
                                </div>

                                <div class="body" data-ng-if="metric.description">

                                    <p>{{ metric.description | truncate:80 }}</p>

                                </div>

                            </div>

                        </li>

                    </ul>
                 -->

                </div>

            </div>

            <h2>Practice Extent</h2>
        <!--    <div style="text-align: left;margin-bottom:20px;">
                         {{page.practice_category.unit.instructions}}
            </div>
         -->
            <ul class="target-lst target-lst-inactive" >

                <li style="display:block; min-height:20px; color:#000000; width: 100%; ">

                         <p style="display:block; clear:both;">
                        The system generates the footprint based on the length or area of this practice's geometry.
                             Many models and practice types use this number to calculate the estimated reductions.
                             To generate estimated reduction calculations,
                             enter the value for the requested unit in the provided field.
                        </p>

                 <!--       <p style="display:block; clear:both;">
                    This is a system-generated number based on the length or area of this practice's geometry. You can provide a separate value in the "custom" field.
                        </p>
                -->
                </li>
                 <li style="height:63px; margin-bottom:20px;" data-ng-if="page.practice.extent.calculated.converted && page.geometryMismatch == false">

                     <div data-ng-if="page.practice_category.unit.unit.plural == 'acres' || page.practice_category.unit.unit.plural == 'linear feet'" style="text-transform:capitalize;">Calculated {{page.practice_category.unit.dimension}} Value</div>
                     <div data-ng-if="page.practice_category.unit.unit.plural != 'acres' && page.practice_category.unit.unit.plural != 'linear feet'" style="text-transform:capitalize;">Calculated Area Value</div>
                  <!--   <div style="float:left; clear:left; color:#666666; font-size:10px;">
                           This is a system-generated number based on the length or area of this practice's geometry. You can provide a separate value in the "custom" field.
                        </div>
                   -->
                     <span style="margin-right: 20px; text-transform:capitalize;">{{page.practice.extent.calculated.converted | number:2}} </span>

                     <span style="text-align: left; width: auto; margin-right: 20px; text-transform:capitalize;">
                         <nobr data-ng-if="page.practice_category.unit.unit.plural == 'acres' || page.practice_category.unit.unit.plural == 'linear feet'">
                             {{page.practice_category.unit.unit.plural}}
                         </nobr>
                         <nobr data-ng-if="page.practice_category.unit.unit.plural != 'acres' && page.practice_category.unit.unit.plural != 'linear feet'" >
                             acres
                         </nobr>
                     </span>

                     <button type="button" class="add-item" data-ng-disabled="page.status.processing" style="margin-right: 20px;">
                        <i class="material-icons">

                        </i>
                    </button>

                    <button type="button" class="add-item" data-ng-disabled="page.status.processing">
                        <i class="material-icons">

                        </i>
                    </button>

                </li>

                  <!--
                -->
                <li style="display:block; min-height:20px; margin-bottom:20px; color:#000000; width: 100%;"
                    data-ng-if="page.practice.geometry.type == 'LineString' && page.practice_category.unit.dimension != 'length'"
                >
                    Calculated Extent Values for this practice are only available with <a href="/practices/{{ page.practice.id }}/location">Polygonal Geometries</a>.
                </li>

                <li style="display:block; min-height:20px; margin-bottom:20px; color:#000000; width: 100%;"
                    data-ng-if="page.practice.geometry.type == 'Polygon' && page.practice_category.unit.dimension != 'area'"
                >
                    Calculated Extent Values for this practice are only available with <a href="/practices/{{ page.practice.id }}/location">Line Geometries</a>.
                </li>
                <!--
                -->

                <li style="height:63px; margin-bottom:20px; font-size:0.8em;"
                    data-ng-if="(!page.practice.extent.calculated.converted && page.practice.geometry.type != 'Point')">
                    A&nbsp;
                    <a href="/practices/{{ page.practice.id }}/location">Practice Location Geometry</a>
                    &nbsp;must be defined for a Calculated&nbsp;
                    <span data-ng-if="page.practice_category.unit.unit.plural == 'acres' || page.practice_category.unit.unit.plural == 'linear feet'" style="text-transform:capitalize;">
                        {{page.practice_category.unit.dimension}}
                    </span>
                     <span data-ng-if="page.practice_category.unit.unit.plural != 'acres' && page.practice_category.unit.unit.plural != 'linear feet'" style="text-transform:capitalize;">
                        area
                    </span>
                    &nbsp;Value to be generated.
                </li>

                <li style="height:63px; margin-bottom:20px; font-size:0.8em;"
                    data-ng-if="page.practice.geometry.type == 'Point' && !page.practice.extent.calculated.converted">
                    Calculated&nbsp;
                    <span data-ng-if="page.practice_category.unit.unit.plural == 'acres' || page.practice_category.unit.unit.plural == 'linear feet'" style="text-transform:capitalize;">
                        {{page.practice_category.unit.dimension}}
                    </span>
                     <span data-ng-if="page.practice_category.unit.unit.plural != 'acres' && page.practice_category.unit.unit.plural != 'linear feet'" style="text-transform:capitalize;">
                        area
                    </span>
                    &nbsp;Values are not available for&nbsp;
                    <a href="/practices/{{ page.practice.id }}/location">Point Geometries</a>.
                </li>



                <li style="display:block; clear:both; color:#000000; width: 100%; ">

                        <p style="display:block; clear:both;" >
                         {{page.practice_category.unit.instructions}}
                        </p>

                </li>

                <li style="height:63px; margin-bottom:8px;">

                    <div style="text-transform:capitalize;">Custom {{page.practice_category.unit.dimension}} Value</div>

                    <input type="number"
                           class="form-control"
                           style="margin-right: 20px; text-align: right; padding-right: 10px;"
                           data-ng-model="page.practice.custom_extent"
                           id="custom_extent"
                           name="custom_extent" placeholder="0" step="0.0001" min="0" autocomplete="off" />

                     <span style="text-align: left; width: auto; margin-right: 20px; text-transform:capitalize;">
                         <nobr > {{page.practice_category.unit.unit.plural}} </nobr>
                     </span>

                     <button type="button" class="add-item" data-ng-click="page.deleteCustomExtent()" data-ng-disabled="page.status.processing" style="margin-right: 20px;">
                        <i class="material-icons">
                            delete
                        </i>
                    </button>

                    <button type="button" class="add-item" data-ng-click="page.savePractice()" data-ng-disabled="page.status.processing">
                        <i class="material-icons">
                            done
                        </i>
                    </button>
                </li>

                <li style="justify-content: flex-end; margin-top: 2em; border-top: 1px solid #e0e0e0; padding-top: 1em;"></li>
            </ul>


            <h2 data-ng-if="page.targets && page.targets.active.length">Active targets</h2>

            <ul class="target-lst" data-ng-if="page.calculating == true">
                <li>
                    <div style="padding-right: 0; text-align:center;">Recalculating metrics...</div>
                </li>
                <li style="justify-content: flex-end; margin-top: 2em; border-top: 1px solid #e0e0e0; padding-top: 1em;">
                    <button type="button" class="add-item" data-ng-click="page.removeAll()" data-ng-disabled="page.status.processing">
                        <i class="material-icons">
                            delete_sweep
                        </i>
                    </button>
                    <button type="button" class="add-item" style="margin-left: 1em;" data-ng-click="page.saveTargets()" data-ng-disabled="page.status.processing">
                        <i class="material-icons">
                            done
                        </i>
                    </button>
                </li>
            </ul>

            <ul class="target-lst" data-ng-if="page.targets && page.targets.active.length && page.calculating == false">
                <li data-ng-repeat="target in page.targets.active">
                    <div>
                        <div> {{ target.metric.name || target.name }}</div>
                        <div data-ng-if="target.metric.model" style="float:left; color:#666666; font-size:10px;">
                           {{target.metric.model.name}}
                        </div>
                    </div>
                    <input type="number" class="form-control" data-ng-model="target.value" id="name-active-{{ $index }}" name="name-active-{{ $index }}" placeholder="0" step="0.0001" min="0" autocomplete="off" data-ng-readonly="target.metric.locked" />

                    <button type="button" class="add-item" data-ng-click="page.removeTarget(target, $index)" data-ng-disabled="page.status.processing || target.metric.locked">
                        <i class="material-icons">
                            remove_circle
                        </i>
                    </button>

                </li>
                <li style="justify-content: flex-end; margin-top: 2em; border-top: 1px solid #e0e0e0; padding-top: 1em;">
                    <button type="button" class="add-item" data-ng-click="page.removeAll()" data-ng-disabled="page.status.processing">
                        <i class="material-icons">
                            delete_sweep
                        </i>
                    </button>
                    <button type="button" class="add-item" style="margin-left: 1em;" data-ng-click="page.saveTargets()" data-ng-disabled="page.status.processing">
                        <i class="material-icons">
                            done
                        </i>
                    </button>
                </li>
            </ul>



            <ul class="target-lst" data-ng-if="(!page.targets || !page.targets.active.length) && page.calculating == false">
                <li>
                    <div style="padding-right: 0; text-align:center;">This practice is not tracking any metrics yet.</div>
                </li>
                <li style="justify-content: flex-end; margin-top: 2em; border-top: 1px solid #e0e0e0; padding-top: 1em;">
                    <button type="button" class="add-item" data-ng-click="page.removeAll()" data-ng-disabled="page.status.processing">
                        <i class="material-icons">
                            delete_sweep
                        </i>
                    </button>
                    <button type="button" class="add-item" style="margin-left: 1em;" data-ng-click="page.saveTargets()" data-ng-disabled="page.status.processing">
                        <i class="material-icons">
                            done
                        </i>
                    </button>
                </li>
            </ul>

            <h2 data-ng-if="page.targets && page.targets.inactive.length">Available metrics</h2>

            <ul class="target-lst target-lst-inactive" data-ng-if="page.targets">
                <li data-ng-repeat="target in page.targets.inactive" data-ng-if="!target.automated && !target.locked">
                    <div>{{ target.name || target.metric.name }}</div>
                    <input type="number" class="form-control" data-ng-model="target.value" id="name-inactive-{{ $index }}" name="name-inactive-{{ $index }}" placeholder="0" step="0.0001" min="0" autocomplete="off" />
                    <button type="button" class="add-item" data-ng-click="page.addTarget(target, $index)" data-ng-disabled="page.status.processing">
                        <i class="material-icons">
                            add_circle
                        </i>
                    </button>
                </li>
            </ul>

        </div>

    </div>

    <div data-ng-if="!page.practice.category"
            class="content--container"
         style="border-right: 1px solid #e0e0e0;">
        <section class="privacy-message reveal fade-in t0">
                <div class="main--ui eveal fade-in">
                   <p>
                    <i class="material-icons">
                        error_outline
                    </i>
                </p>

                <p>
                    A <a href="/practices/{{ page.practice.id }}/edit">Practice Type</a> must be specified before metric targets can be added.
                    <br>
                    Practice Types can be specified on the <a href="/practices/{{ page.practice.id }}/edit">Practice Edit Page</a>.
                </p>
            </div>
          </section>
    </div>


    <nav id="toolbar" class="toolbar" style="float: none; width: auto;" data-ng-if="$root.user.id">
        <ul>
            <li>
                <a href="/practices/{{ page.practice.id }}">
                    <i class="material-icons">
                        dashboard
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.edit}">
                <a href="/practices/{{ page.practice.id }}/edit">
                    <i class="material-icons">
                        edit
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editLocation}">
                <a href="/practices/{{ page.practice.id }}/location">
                    <i class="material-icons">
                        location_on
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editPhotos}">
                <a href="/practices/{{ page.practice.id }}/photos">
                    <i class="material-icons">
                        insert_photo
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editTargets}">
                <a href="/practices/{{ page.practice.id }}/targets">
                    <i class="material-icons">
                        multiline_chart
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editTags}">
                <a href="/practices/{{ page.practice.id }}/tags">
                    <i class="material-icons">
                        local_offer
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit">
                <div class="confirm--delete--popup" data-ng-if="page.deletionTarget">
                    <p>Do you want to delete this practice?</p>
                    <div class="actions">
                        <a class="snapshot--title" href="#" title="Delete forever" data-ng-click="page.deleteFeature()">
                            Yes
                        </a>
                        <a class="snapshot--title" href="#" title="Cancel" data-ng-click="page.cancelDelete()">
                            Cancel
                        </a>
                    </div>
                </div>
                <a href="#" data-ng-click="page.confirmDelete(page.practice)">
                    <i class="material-icons">
                        delete
                    </i>
                </a>
            </li>
        </ul>
    </nav>

    <div class="transient--notification" data-ng-class="{show: page.alerts.length}">
        <div class="event--container">
            <div data-ng-repeat="alert in page.alerts" data-ng-class="{error: alert.type == 'error', success: alert.type == 'success'}">
                <span class="event--message">{{ alert.msg }}</span>
            </div>
        </div>
    </div>

</main>

<div data-ng-include="'/templates/footer--view.html'"></div>