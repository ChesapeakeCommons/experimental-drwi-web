<div data-ng-include="'/templates/header--view.html'"></div>

<main class="site--content--flow fluid-content clearfix distinguish">

    <div id="sidebar" data-ng-include="'/templates/side-bar.html'"></div>

    <div class="content--container" style="border-right: 1px solid #e0e0e0;">

        <div class="progress--modal reveal fade-in t0" data-ng-if="page.status.loading">
            <div class="progress--container">
                <p style="font-weight: bold;" class="color-pulse">Loading practice location&hellip;</p>
            </div>
        </div>

        <section class="privacy-message reveal fade-in t0" data-ng-if="!page.status.loading && page.makePrivate">

            <p>
                <i class="material-icons">
                    lock
                </i>
            </p>

            <p>This practice is private.</p>

        </section>

        <div class="main--ui breadcrumb-ui">
           <div class="group">
                    <article class="breadcrumb" >
                        <p>
                            <nobr>
                                Project: <a href="/projects/{{page.practice.properties.project.properties.id}}">{{page.practice.properties.project.properties.name}}</a>
                                    /
                            </nobr>
                            <nobr>
                                   <!-- <sub><i class="icon material-icons" style=""> chevron_right</i></sub> -->
                                Site: <a href="/sites/{{page.site.properties.id}}">{{page.site.properties.name}}</a>
                                    /
                            </nobr>
                            <nobr>
                                Practice: <a href="/practices/{{page.practice.properties.id}}">{{ page.practice.properties.name }}</a>
                                    / Edit location
                            </nobr>
                        </p>
                    </article>
                </div>
        </div>
        <div class="breadcrumb-header-wrapper">
            <h1 class="inset breadcrumb-header reveal fade-in t0" data-ng-if="!page.status.loading && !page.makePrivate">Edit location</h1>
        </div>
        <div class="main--ui reveal fade-in t0" data-ng-if="!page.status.loading && !page.makePrivate">

            <form role="form" class="form" style="position:relative;" id="form--PracticeEdit" name="form--PracticeEdit" data-ng-submit="page.savePractice();" autocomplete="off">

                <!-- Practice Type -->

                <div class="form-element">
                    <span class="meta-label"><b>Practice type</b></span>
                    <input id="practice_type_id" name="practice_type_id" type="text" data-ng-model="page.practiceType.name" disabled readonly />
                    <p style="font-style: normal; color: #616161; font-size: 0.9em; margin-top: 1em;">
                        {{ page.practice.properties.category.description }}
                    </p>
                </div>

                <p style="font-size: 1em; font-style: normal;"><strong>Address</strong></p>

                <div id="geocoder" class="geocoder"></div>

                <div style="position:relative; border-radius: 4px; overflow: hidden;">

                    <div id="primary--map" class="map tall" style="border-radius: 4px; overflow: hidden;">
                        <div class="mapboxgl-layer-ctrl" data-ng-click="page.showLayerOptions = !page.showLayerOptions" title="Switch layers">
                            <i class="material-icons">
                                layers
                            </i>
                            <div class="layer-group" data-ng-show="page.showLayerOptions">
                                <label data-ng-repeat="style in page.mapStyles" data-ng-class="{'active': page.activeStyle === $index}" title="{{ style.name }}">
                                    <input type="radio" id="base-style-{{ $index }}" name="active-style" data-ng-model="page.activeStyle" data-ng-value="{{ $index }}" data-ng-change="page.switchMapStyle(style, $index)"><span> {{ style.name }}</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <div style="background: #fff;" class="progress--modal" data-ng-if="page.progressValue && page.progressValue > 0">
                        <div class="progress--container">
                            <p style="text-align: left;">
                                <strong>{{ page.progressMessage }}</strong>
                            </p>
                            <div class="progress--meter--bar--wrapper">
                                <div class="progress--meter--bar" style="width: {{ page.progressValue }}%;"></div>
                            </div>
                        </div>
                    </div>

                </div>


                <!-- Draw instructions -->
                <div class="form-field">
                    <p style="font-style: normal; font-size: 1em; margin-top: 1.5em;">
                        <strong>Draw Practice Location</strong>
                    </p>
                    <p style="font-style: normal; font-size: 1em; margin-top: 1em; color: #616161;">
                        If you do not have a shapefile of your practice area then you can draw your practice directly in FieldDoc.
                        To draw your polygon, select select the square polygon draw tool, third from the bottom of available tools.
                        Estimate your practice area and double click to complete the shape.
                        FieldDoc uses the delineated polygon area to calculate the estimated reductions.
                        IMPORTANT: Only use the polygon tool when delineating your practice area.
                        Using the line or the point tools will calculate estimated reductions of zero,
                        even if you create a polygon shape with either of those drawing tools.
                    </p>
                </div>
                <!-- Shapefile input -->
                <div class="form-field">
                    <p style="font-style: normal; font-size: 1em; margin-top: 1.5em;">
                        <strong>Upload GeoJSON or an ESRI Shapefile</strong>
                    </p>
                    <p style="font-style: normal; font-size: 1em; margin-top: 1em; color: #616161;">In addition to the mandatory <span style="font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;">.shp</span>, <span style="font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;">.shx</span>, and <span style="font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;">.dbf</span> files, shapefile archives must include a <span style="font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;">.prj</span> file that describes the coordinate system and projection.
                    All files must be compressed into a .zip file before uploading.
                    </p>

                    <p style="font-style: normal; font-size: 1em; margin-top: 1em; color: #616161;">GeoJSON files must use the <span style="font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;">.json</span> or <span style="font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;">.geojson</span> file extensions and follow the format described in <a href="https://tools.ietf.org/html/rfc7946" target="_blank">this specification</a>. We recommend testing GeoJSON data with <a href="http://geojson.io" target="_blank">geojson.io</a> before uploading it to FieldDoc. See <a href="https://www.mapbox.com/help/define-geojson/" target="_blank">here</a> for more help with the GeoJSON format.</p>

                    <input type="file" class="form-control" id="shapefile" name="shapefile" file-upload file-model="page.fileImport" file-on-change="page.uploadShapefile()" />

                    <p style="font-style: normal; font-size: 1em; margin-top: 1em; color: #616161;">Regardless of type, file uploads cannot exceed 100MB. For shapefile archives, this is the maximum total size of all <strong>un-compressed</strong> files.</p>

                    <!-- <p style="font-style: normal; font-size: 1em; margin-top: 1em;">
                        <strong>Upload an ESRI Shapefile</strong>
                    </p>
                    <p style="font-style: normal; font-size: 1em; margin-top: 1em; color: #616161;">In addition to the mandatory .shp, .shx, and .dbf files, your archive must include a .prj file that describes the coordinate system and projection.</p>
                    <input type="file" class="form-control" id="shapefile" name="shapefile" file-upload file-model="page.fileImport" file-on-change="page.uploadShapefile()" /> -->
                </div>

                <div class="save--action--wrapper save--action--bottom">
                    <button type="submit" data-ng-disabled="page.status.processing">
                        <i class="material-icons" data-ng-if="page.status.processing">
                            more_horiz
                        </i>
                        <i class="material-icons" data-ng-if="!page.status.processing">
                            done
                        </i>
                    </button>
                </div>

            </form>

        </div>

    </div>

    <nav id="toolbar" class="toolbar" style="float: none; width: auto;" data-ng-if="$root.user.id">
        <ul>
            <li>
                <a href="/practices/{{ page.practice.id }}">
                    <i class="material-icons">
                        dashboard
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.edit}">
                <a href="/practices/{{ page.practice.id }}/edit">
                    <i class="material-icons">
                        edit
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editLocation}">
                <a href="/practices/{{ page.practice.id }}/location">
                    <i class="material-icons">
                        location_on
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editPhotos}">
                <a href="/practices/{{ page.practice.id }}/photos">
                    <i class="material-icons">
                        insert_photo
                    </i>
                </a>
            </li>
            <!-- <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.partnerships}">
                <a href="/practices/{{ page.practice.id }}/partnerships">
                    <i class="material-icons">
                        group_work
                    </i>
                </a>
            </li> -->
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editTargets}">
                <a href="/practices/{{ page.practice.id }}/targets">
                    <i class="material-icons">
                        multiline_chart
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editTags}">
                <a href="/practices/{{ page.practice.id }}/tags">
                    <i class="material-icons">
                        local_offer
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit">
                <div class="confirm--delete--popup" data-ng-if="page.deletionTarget">
                    <p>Do you want to delete this practice?</p>
                    <div class="actions">
                        <a class="snapshot--title" href="#" title="Delete forever" data-ng-click="page.deleteFeature()">
                            Yes
                        </a>
                        <a class="snapshot--title" href="#" title="Cancel" data-ng-click="page.cancelDelete()">
                            Cancel
                        </a>
                    </div>
                </div>
                <a href="#" data-ng-click="page.confirmDelete(page.practice)">
                    <i class="material-icons">
                        delete
                    </i>
                </a>
            </li>
        </ul>
    </nav>

    <div class="transient--notification" data-ng-class="{show: page.alerts.length}">
        <div class="event--container">
            <div data-ng-repeat="alert in page.alerts" data-ng-class="{error: alert.type == 'error', success: alert.type == 'success'}">
                <span class="event--message">{{ alert.msg }}</span>
            </div>
        </div>
    </div>

</main>

<div data-ng-include="'/templates/footer--view.html'"></div>