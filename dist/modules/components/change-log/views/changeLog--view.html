<div data-ng-include="'/templates/header--view.html'"></div>

<main class="site--content--flow fluid-content clearfix distinguish">

    <div id="sidebar" data-ng-include="'/templates/side-bar.html'"></div>

    <div class="content--container" style="border-right: 1px solid #e0e0e0;">

        <div class="progress--modal reveal fade-in t0" data-ng-if="page.status.loading">
            <div class="progress--container">
                <p style="font-weight: bold;" class="color-pulse">Loading project data&hellip;</p>
            </div>
        </div>

        <section class="privacy-message reveal fade-in t0" data-ng-if="!page.status.loading && page.makePrivate">

            <p>
                <i class="material-icons">
                    lock
                </i>
            </p>

            <p>This project is private.</p>

        </section>

        <div class="main--ui breadcrumb-ui">
           <div class="group">
                    <article class="breadcrumb" >
                       <p>
                        <nobr data-ng-if="!page.feature.project">
                            Project: <a href="/projects/{{page.feature.id}}">{{page.feature.name}}</a>
                            /
                        </nobr>
                        <nobr data-ng-if="page.feature.project">
                            Project: <a href="/projects/{{page.feature.project.id}}">{{page.feature.project.name}}</a>
                            /
                        </nobr>

                           <nobr data-ng-if="page.feature.project && (page.feature.site != undefined)">
                            Site A: <a href="/sites/{{page.feature.site.id}}">{{page.feature.site.name}}</a>
                            /
                        </nobr>
                        <nobr data-ng-if="page.feature.project && page.feature.site == undefined)">
                            Site B: <a href="/sites/{{page.feature.id}}">{{page.feature.name}}</a>
                            /
                        </nobr>

                        <nobr>
                            History

                        </nobr>
                       </p>
                    </article>
                </div>
        </div>
        <div class="breadcrumb-header-wrapper">
            <h1 class="inset breadcrumb-header" data-ng-if="!page.status.loading && !page.makePrivate">
                {{page.featureType}} history
            </h1>
        </div>
        <div class="main--ui" data-ng-if="!page.status.loading && !page.makePrivate">

                <div class="group reveal fade-in t2">

                        <section class="shadow">
                         <!--   <a name="practiceTypes">
                            <h2>{{self.FeatureType}} History</h2>
                            </a>
                            -->
                          <!--  <p>
                                Showing <b>{{ practiceList.length }}</b> of <b>{{ page.program.practices.length }}</b> total practices types in program <b>{{page.program.name}}</b>.
                            </p>
                            -->

                               <div class="collection-search reveal fade-in t0" style="border: 0px solid red;
                                                                            justify-content:left;
                                                                            align-items:left;
                                                                            overflow: auto;
                                                                            flex-wrap: wrap;
                                                                             "
                                 >

                                     <input style="float:left; display:inline-block; clear:right;" type="text" class="search-bar list-filter" data-ng-if="!page.status.loading" data-ng-model="page.queryToken" placeholder="Search history">


                                </div>

                            <div class="selectable-group-items list-unstyled" style="margin-top: 2em;">


                                <div class="selectable-group-items card reveal fade-in pad shadow"
                                    style=" width: 100%;
                                            animation-delay: {{ $index * 100 }}ms;
                                            min-height: 0;
                                            border: 0px solid blue;
                                            background-color: #f5f5f5;
                                            margin-bottom: 16px;
                                            "
                                    data-ng-repeat="group in page.changeLog"
                                   >
                                    <h2>
                                         {{group.weekday}} {{group.date}}
                                    </h2>

                                 <!--   <div class=""
                                         style="border:1px solid red;
                                                float:left;
                                                width:100%;
                                                display:block;
                                                clear:both;
                                                animation-delay: {{ $index * 100 }}ms;
                                                min-height: 0;
                                                "
                                        data-ng-repeat="changes in group.changes = (group)"
                                       >
                                       -->
                                    <div data-ng-repeat="changeLogItem in group.changes | filter: page.queryToken">
                                        <div class="card--content" style="margin-bottom:2px;">

                                            <div class="name" style="border:0px solid pink;
                                                                    width:100%;
                                                                    height:45px;
                                            ">
                                         <!--   <div class="name" style="flex-flow: column; align-items: flex-start;">-->

                                                <div style="position:relative;
                                                            width:25%;
                                                            max-width:200px;
                                                            min-width:200px;
                                                            float:left;
                                                            font-weight: normal;
                                                            color: #757575;
                                                            border:0px solid blue;
                                                            "
                                                >
                                                     <a href="/profile/{{changeLogItem.creator.id}}">
                                                         <b>{{ changeLogItem.creator.first_name }} {{ changeLogItem.creator.last_name }}</b>
                                                      </a>

                                                </div>

                                               <div style="position:relative;
                                                            width:60%;
                                                            float:left;
                                                            font-weight: normal;
                                                            color: #757575;
                                                            border:0px solid blue;
                                                            "
                                                >
                                                    <span style="font-size: 1.0em; font-weight: normal; color: #757575;">
                                                        {{ changeLogItem.timestamp.local | date:'medium' }}

                                                    </span>


                                               </div>
                                                 <div style="position:relative;
                                                              float:left;
                                                                width:30%;
                                                              font-weight: normal;
                                                              color: #757575;
                                                                border:0px solid orange;
                                                                text-align:right;
                                                                "
                                                  >

                                                      <span for="changeLogItem-{{ changeLogItem.id }}">
                                                        {{ changeLogItem.action_label }}
                                                    </span>
                                                  </div>


                                            </div>

                                            <!-- <label class="name" for="practice-{{ practice.id }}" style="flex-flow: column; align-items: flex-start;">
                                                {{ practice.name }}
                                                <span style="font-size: 0.7em; font-weight: normal; color: #757575; text-transform: uppercase;" data-ng-if="practice.group">{{ practice.group }}</span>
                                            </label> -->

                                            <div class="body" style="padding: 0px 0px 0px 0px">
                                                <div style="width:100%; height: 35px; " data-ng-if="changeLogItem.diff != null">
                                                    <div style="position:relative;
                                                                float:left;
                                                                height: 35px;
                                                                text-align:center;
                                                                width:50%;
                                                                border:0px solid blue;
                                                                background-color:#f2fff3;
                                                                 color: #757575;
                                                                 font-size:1.0em;
                                                                "

                                                    ><b>CHANGE</b></div>
                                                     <div style="position:relative;
                                                                float:left;
                                                                text-align:center;
                                                                width:50%;
                                                                height: 35px;
                                                                border:0px solid black;
                                                                background-color:#fff2f2;
                                                                color: #757575;
                                                                 font-size:1.0em;
                                                                "
                                                     ><b>PREVIOUS</b></div>
                                                </div>
                                                <div data-ng-repeat="(key, item) in changeLogItem.diff"
                                                    style="background-color:#fff2f2;">
                                                    <div style="width:50%;
                                                                    position:relative;
                                                                    float:left;
                                                                    border: 0px solid red;
                                                                    background-color:#f2fff3;
                                                                    padding-left:20px;
                                                                    padding-right:20px;
                                                                    color: #757575;
                                                                     font-size:1.0em;
                                                                    ">

                                                        {{key}} :
                                                              <p style="padding-left:20px;" data-ng-if="key != 'geometry'">
                                                                  {{item.new_display || item.new_value}} &nbsp;</p>
                                                           <!--       {{item.new_display}} </p>
                                                           -->

                                                            <p  style="padding-left:20px;" data-ng-if="key == 'geometry'">
                                                                <img src="{{item.new_staticURL}}"/>
                                                            </p>


                                                    </div>
                                                    <div style="width:50%;
                                                                    position:relative;
                                                                    float:left;
                                                                    border: 0px solid red;
                                                                    padding-left:20px;
                                                                    padding-right:20px;
                                                                     color: #757575;
                                                                      font-size:1.0em;
                                                                    ">

                                                         {{key}} :
                                                             <p style="padding-left:20px;" data-ng-if="key != 'geometry'" >
                                                                {{item.previous_display || item.previous_value}} &nbsp; </p>
                                                              <!--  {{item.previous_display || item.previous_value}} </p>
                                                                -->
                                                            <p  style="padding-left:20px;" data-ng-if="key == 'geometry'">
                                                                <img src="{{item.previous_staticURL}}"/>
                                                            </p>


                                                    </div>

                                                </div>

                                            </div>

                                        </div>
                                            </div>
                                 <!--   </div>
                                 -->

                                </div>


                            </div>

                        </section>

                    </div>


                </div>

            </div>
        </div>

    </div>

        <nav id="toolbar" class="toolbar" style="float: none; width: auto;" data-ng-if="$root.user.id">
        <ul>
            <li data-ng-class="{active: $root.toolbarState.dashboard}">
                <a href="/projects/{{ page.project.id }}" title="Summary">
                    <i class="material-icons">
                        dashboard
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit">
                <a href="/projects/{{ page.project.id }}/edit" title="Edit">
                    <i class="material-icons">
                        edit
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.grant}">
                <a href="/projects/{{ page.project.id }}/grant" title="Program">
                    <i class="material-icons">
                        account_balance
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit">
                <a href="/projects/{{ page.project.id }}/users" title="Collaborators">
                    <i class="material-icons">
                        group
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.partnerships}">
                <a href="/projects/{{ page.project.id }}/partnerships" title="Partnerships">
                    <i class="material-icons">
                        group_work
                    </i>
                </a>
            </li>
            <!-- <li data-ng-if="page.permissions.can_edit">
                <a href="/projects/{{ page.project.id }}/edit">
                    <i class="material-icons">
                        edit
                    </i>
                </a>
            </li> -->
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editTargets}">
                <a href="/projects/{{ page.project.id }}/targets" title="Metrics">
                    <i class="material-icons">
                        multiline_chart
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit" data-ng-class="{active: $root.toolbarState.editTags}">
                <a href="/projects/{{ page.project.id }}/tags" title="Tags">
                    <i class="material-icons">
                        local_offer
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit">
                <a href="#" data-ng-click="page.print()" title="Print">
                    <i class="material-icons">
                        print
                    </i>
                </a>
            </li>
            <li data-ng-if="page.permissions.can_edit">
                <div class="confirm--delete--popup" data-ng-if="page.deletionTarget && page.deletionTarget.feature.id === page.project.id && page.deletionTarget.collection === 'project'">
                    <p>Do you want to delete this project?</p>
                    <div class="actions">
                        <a class="snapshot--title" href="#" title="Delete forever" data-ng-click="page.deleteFeature('project')" >
                            Yes
                        </a>
                        <a class="snapshot--title" href="#" title="Cancel" data-ng-click="page.cancelDelete()" >
                            Cancel
                        </a>
                    </div>
                </div>
                <a href="#" data-ng-click="page.confirmDelete(page.project, 'project')" title="Delete">
                    <i class="material-icons">
                        delete
                    </i>
                </a>
            </li>
        </ul>
    </nav>

    <div class="transient--notification" data-ng-class="{show: page.alerts.length}">
        <div class="event--container">
            <div data-ng-repeat="alert in page.alerts" data-ng-class="{error: alert.type == 'error', success: alert.type == 'success'}">
                <span class="event--message">{{ alert.msg }}</span>
            </div>
        </div>
    </div>

</main>

<div data-ng-include="'/templates/footer--view.html'"></div>